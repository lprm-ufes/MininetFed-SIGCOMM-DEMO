# Execution Settings

Most of the experiment settings are passed to MininetFed via the `topology.py` file, which follows the Mininet standard.

```bash
sudo python3 topology.py
```

It is possible to edit the file left in the MininetFed folder as an example or create your own.

Some basic elements related to MininetFed are:

```python
from federated.node import Server, Client
from federated.net import MininetFed
```

## MininetFed

Instanciates a Mininet network with some basic components already included. These are:

- MQTT broker (mosquitto)
- Network monitor
- Autostop
- Experiment controller

### MQTT Broker

Searches for the `mosquitto.conf` configuration file by default in the root directory of MininetFed.

### Network Monitor

Consumes network data to generate a log that can be used during experiment analysis.

### Autostop

Utility that synchronizes device execution during federated learning, ensuring that the main code execution in `topology.py`.

---

### _broker_image:_

Image to be used to instantiate a Docker container for the MQTT broker. It is recommended to use the standard image provided with MininetFED, but it is possible to create a custom MQTT broker by modifying this option.

### _experiments_folder:_

Folder where experiment folders are created.

## Experiment

```bash
experiment:
  new_experiment: (true or false)
  experiment_name: (string)
  trainer_mode: (string)
  max_n_rounds: (int)
  stop_accuracy: (float, 0 <= n <= 1)
  min_trainers: (int)
```

### _new_experiment:_

Defines whether MininetFED should automatically create a new folder for the experiment or continue filling in an existing experiment folder.

**True:**

Searches or creates a directory for the experiment in the following format:

```bash
(experiments_folder)/YYYY_MM_DD_(experiment_name)
```

**False:**

Searches for the experiment folder by name. If the directory does not exist, MininetFED will display an error.

```bash
(experiments_folder)/(experiment_name)
```

### _experiment_name:_

Experiment name to reference the folder where results will be stored.

### _trainer_mode:_

This option is passed directly to the Trainer. Selects predefined data division modes and Trainer operation modes.

### _max_n_rounds:_

Option passed to the server to set the maximum number of rounds of communication between the server and client, defining a stopping condition.

### _stop_accuracy:_

Option that defines a stopping condition based on the average accuracy of the model generated by combining models generated by each trainer.

### _min_trainers:_

Defines the minimum number of connected clients before initializing training.

### Note:

The first condition to be met will be responsible for interrupting execution. The cause of interruption will be recorded in the training log.

## Network

```python
network_monitor_script: string;
network_monitor_image: string;
network_components: int;
```

### _network_monitor_script_

Address of the network monitor script. Use the standard script left in the example file or modify to create a custom monitor.

### _network_monitor_image_

Image used in the network monitor container. Use the standard image left in the example file or modify to create a custom monitor.

### _network_components_

Number of switches in the network for creating complex network topologies. In a simple network, leave the value as "1".

## Server

```python
  memory: (int)m
  vCPU_percent: (int 0 - 100)
  image: (string)
  volume: (string)
  conection: (int)
  script: (string)
```

### _memory:_

Maximum amount of memory to be used by the server Docker container

### _vCPU_percentage:_

Percentage of available processing power dedicated to the server. For more details, see the vCPU section in the documentation.

### _image:_

Docker image to be used on the server. Use the standard image left in the example file or modify to create a custom server.

### _Connection:_

Defines which switch you want to connect the server to. The value is a number from 1 to N representing the switch ID. This option is used to create more complex network topologies.

### _Script:_

Address of the server execution file.

## Clients

This option is dedicated to defining one or more types of clients to be instantiated during the experiment.

The `clients` structure consists of a list with client types:

```python
Clients:
-   amount: (int)
    name: (string)
    memory: (string)m
    vCPU_percent: (int 0 - 100)
    image: (string)
    script:(string)
    connection: (int)
    loss: (float 0 <= n <= 1)
    delay: (int)ms
    bw: (int)

  - (other client type)
...
```

### _amount_

Number of clients of the current type to be instantiated during experiment execution

### _name_

Client name. Do not use spaces or special characters. In case of problems during instantiation, check if a prohibited character was used.

### _memory_

Maximum amount of memory to be used by each client Docker container

### _vCPU_percentage:_

Percentage of available processing power dedicated to each client instance. For more details, see the vCPU section in the documentation.

### _image:_

Docker image to be used on the client. Use the standard image left in the example file or modify to create a custom client.

### _Script:_

Address of the client execution script for the current type.

### _Connection:_

Defines which switch you want to connect the client of the current type to. The value is a number from 1 to N representing the switch ID. This option is used to create more complex network topologies. For example, one client type can be connected to switch 1, and another type to switch 2, with a predefined delay, bandwidth, and loss between switches 1 and 2.

### _loss_

Percentage of data loss between the client and switch it is connected to.

### _delay_

Delay in milliseconds that the connection between the switch and client will have

### _bw_

Bandwidth between the client and switch it is connected to. The default unit is Mbps.